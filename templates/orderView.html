{% extends "layout.html" %}

{% block body %}
{% load crispy_forms_tags %}
{% if order %}
<div class="row mb-1">
    <div class="col-md-6">
      <div class="row g-0 border rounded overflow-hidden flex-md-row mb-4 shadow-sm h-md-250 position-relative">
        <div class="col p-4 d-flex flex-column position-static">
          <strong class="d-inline-block mb-2 text-primary">Sipariş ID: {{order.id}} </strong>
          <h3 class="mb-0">{{order.customer.customer_name}}</h3>
          <div class="mb-1 text-muted">{{order.created_date}}</div>
          <p class="card-text mb-auto">{{order.content|safe}}</p>
          <a href="/order/customerView/{{order.customer.id}}" class="stretched-link">Müşteri Detay</a>
        </div>
        
      </div>
    </div>
	
    <div class="col-md-3">
        <div class="row g-0 border rounded overflow-hidden flex-md-row mb-4 shadow-sm h-md-250 position-relative">
            <div class="col p-4 d-flex flex-column position-static">
                <h5 class="mb-0">İletişim</h5>
                <div >email : {{order.customer.email}}</div> 
                <div class="mb-1 text-muted">Telefon:{{order.customer.telephone}}</div> 
            </div>
        </div>
    </div>

    <div class="col-md-3">
            <div class="col-auto d-none d-lg-block">
                
                {% if order.order_image.url is not Null %}
                    <a href="{{order.order_image.url}}" target="popup" 
                    onclick="window.open('{{order.order_image.url}}','popup','width=600,height=600'); return false;">
                        <img width="200" height="200"  class="img-fluid rounded" src="{{order.order_image.url}}" alt="">  
                    </a>
                {% endif %}

            </div>
    </div>

</div>

<div >
    <div class="jumbotron border rounded overflow-hidden ">
        <h3> Ürünler &nbsp;&nbsp;&nbsp;&nbsp; <a href="/order/orderAddProduct/{{order.id}}">
            <button class="btn btn-success btn-sm">
              <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-bag-plus" viewBox="0 0 16 16">
                <path fill-rule="evenodd" d="M8 7.5a.5.5 0 0 1 .5.5v1.5H10a.5.5 0 0 1 0 1H8.5V12a.5.5 0 0 1-1 0v-1.5H6a.5.5 0 0 1 0-1h1.5V8a.5.5 0 0 1 .5-.5z"/>
                <path d="M8 1a2.5 2.5 0 0 1 2.5 2.5V4h-5v-.5A2.5 2.5 0 0 1 8 1zm3.5 3v-.5a3.5 3.5 0 1 0-7 0V4H1v10a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V4h-3.5zM2 5h12v9a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V5z"/>
              </svg>Siparişe Ürün Ekle
            </button>
          </a>
        </h3>
        <br><br>
            {% if orderProducts %}
                <table class="table table-striped table-hover">
                    <thead>
                        <tr>
                            <th scope="col"></th>
                            <th scope="col">Ürün</th>
                            <th scope="col">Adet</th>
                            <th scope="col">Renk</th>
                            
                        </tr>
                    </thead>

                {% for orderProduct in orderProducts%}
                    <tr>
                    <th scope="row">{{orderProduct.id}}</th>                    
                    <td>{{orderProduct.product.product_name}}</td>
                    <td>{{orderProduct.amount}}</td>
                    <td>{{orderProduct.colour}}</td>
                    
                    </tr>
                {% endfor%}

                </table>
                <a href="/order/orderApproved/{{order.id}}">
                    <button class="btn btn-warning btn-sm">Siparişi onayla</button>
                </a>
            {% endif%}
       <br><br>
    </div>

    <br><br>
    
    <div class="jumbotron border rounded overflow-hidden ">
        <h3> 
            İşlemler<br><br>
            {% if workflows %}
                <table class="table table-striped table-hover">
                    <thead>
                        <tr>
                            <th scope="col"></th>
                            <th scope="col">Departman</th>
                            <th scope="col">Açıklama</th>
                            <th scope="col">Durum</th>
                            <th scope="col">Oluşturulma tarihi</th>
                            <th scope="col">Tamamlanma tarihi</th>
                            
                        </tr>
                    </thead>
                   
                
                {% for wf in workflows%}
                    <tr>
                    <th scope="row">{{wf.id}}</th>                    
                    <td>{{wf.department}}</td>
                    <td>{{wf.comment}}</td>
                    <td>{{wf.status}}</td>
                    <td>{{wf.created_date}}</td>
                    <td>{{wf.completed_date}}</td>
                    
                    </tr>
                  
                {% endfor%}
                </table>
            {% endif%}
        </h3>  
    </div>


    {%else%}
    <div class="alert alert-danger">
        Sipariş bulunamadı
    </div>
    {% endif %}
    

 

{% endblock body %}