{% extends "layout.html" %}

{% block body %}
{% load crispy_forms_tags %}



<!--   ---------------------------------------------  -->
<script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.9.0/moment-with-locales.js"></script>
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datetimepicker/4.14.30/js/bootstrap-datetimepicker.min.js"></script>
<link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datepicker/1.3.0/css/datepicker.min.css">
<link rel="stylesheet" type="text/css" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" />
<script>

    $(document).ready(function () {
            $('#tahmini_tarih_min').datetimepicker({
                format: 'YYYY-MM-DD',
                useCurrent: true,
                keepOpen: true,
                allowInputToggle: true,
                
                ignoreReadonly: true,
                showTodayButton: true,
                viewMode: 'days'
            });
            $('#id_tahmini_tarih_max').datetimepicker({
                format: 'YYYY-MM-DD',
                useCurrent: true,
                keepOpen: true,
                allowInputToggle: true,
                
                ignoreReadonly: true,
                showTodayButton: true,
                viewMode: 'days'
            });
            $('#divEndDate').datetimepicker({
                format: 'YYYY-MM-DD',
                useCurrent: false,
                keepOpen: true,
                allowInputToggle: true,
                maxDate: new Date(),
                ignoreReadonly: true,
                showTodayButton: true,
                viewMode: 'days'
            });
            $('#id_tahmini_tarih_min').datetimepicker({
                format: 'YYYY-MM-DD',
                useCurrent: true,
                keepOpen: true,
                allowInputToggle: true,
                
                ignoreReadonly: true,
                showTodayButton: true,
                viewMode: 'days'
            });
            

    });
    
    </script>
<!--   ---------------------------------------------  -->



<div class="row">
  
    <h3> 
            Siparişe ürün Ekleme
            
    </h3>   
   <br><br>
   <form method="post" enctype="multipart/form-data" id="orderProductForm" data-product-url="{% url 'order:ajax_productDropList' %}" data-product-url2="{% url 'order:ajax_colorList' %}"   data-product-url3="{% url 'order:ajax_categoryDropList' %}">
   
        {% csrf_token %}
       
        

        {{ form.media }}

        

        <div class="row">
            <div  class="col-md-2 mb-0">
                {{ form.urun_grubu|as_crispy_field }}
            </div>
            <div  class="col-md-2 mb-0">
                {{ form.product_category|as_crispy_field }}
            </div>
            <div  class="col-md-2 mb-0">
                {{ form.product|as_crispy_field }}
            </div>
            <div  class="col-md-2 mb-0">
                {{ form.colour|as_crispy_field }}
            </div>
            <div  class="col-md-2 mb-0">
                {{ form.amount|as_crispy_field }}
            </div>
            
        </div> 
      
        <br>

        <button type="submit" class="btn btn-warning">Giriş</button>
    </form>

</div>


<!--   ---------------------------------------------  -->
<script>

    function showCategoryFunction(val,t) { //   t = objenin idsi
        var url = $("#orderProductForm").attr("data-product-url3");  // sorgunun yapılacağı url
        var urun_grubu = document.getElementById("id_urun_grubu").value;
        

        $.ajax({                       //  AJAX request oluşturuluyor.  view içinde productDropList çalıştırılır
            url: url,                    // url formdan alınıyor
            data: {
            'urun_grubu': urun_grubu       // urun grubuna bağlı olan ürünlerin kategorilerini getirir.

            },
            success: function (data) {   // data allınır
        
            $("#id_product_category").html(data);  // alınan data listeye eklenir
            }
        });

      }


    function myFunction(val,t) { //   t = objenin idsi
        var url = $("#orderProductForm").attr("data-product-url");  
     
        
        if ( t[10] == "u" ){    //urun grubu change olmuş
            var urun_grubu = val;  // urun grubu değeri alınır
            //var marka = document.getElementById("id_form-"+t[8]+"-marka").value;
            var kategori = document.getElementById("id_product_category").value;
            
        }else {                 //kategori change olmuş
            var urun_grubu = document.getElementById("id_urun_grubu").value;
            //var marka = val ;
            var kategori = val;

        }
        

        $.ajax({                       //  AJAX request oluşturuluyor.  view içinde productDropList çalıştırılır
            url: url,                    // url formdan alınıyor
            data: {
            'urun_grubu': urun_grubu ,      // add the country id to the GET parameters
            //'marka': marka 
            'kategori':kategori
            },
            success: function (data) {   // `data` is the return of the `load_cities` view function
            //$("#id_product").html(data);  // replace the contents of the city input with the data that came from the server
            $("#id_product").html(data);  // replace the contents of the city input with the data that came from the server
            }
        });

      }
      //    kategori için burası güncellenecek
      //    view içinde categoryDropList çalıştırılıyor
      function colorFunction(val,t) { //   t = objenin idsi
        var url = $("#orderProductForm").attr("data-product-url3");  // formdan url alınıyor
        
        var product_id = document.getElementById("id_product").value;
        
        $.ajax({                       // ajax request oluşturulur
            url: url,                    // set the url of the request (= localhost:8000/hr/ajax/load-cities/)
            data: {
            'product_id': product_id       // add the country id to the GET parameters
            
            },

            success: function (data) {   // `data` is the return of the `load_cities` view function
            //$("#id_product").html(data);  // replace the contents of the city input with the data that came from the server
            $("#id_colour").html(data);  // replace the contents of the city input with the data that came from the server
            }
        });
        alert(data);

      }



      //    renk için burası güncellenecek
      //    view içinde colorList çalıştırılıyor
      function colorFunction(val,t) { //   t = objenin idsi
        var url = $("#orderProductForm").attr("data-product-url2");  // formdan url alınıyor
        
        var product_id = document.getElementById("id_product").value;
        
        $.ajax({                       // ajax request oluşturulur
            url: url,                    // set the url of the request (= localhost:8000/hr/ajax/load-cities/)
            data: {
            'product_id': product_id       // add the country id to the GET parameters
            
            },

            success: function (data) {   // `data` is the return of the `load_cities` view function
            //$("#id_product").html(data);  // replace the contents of the city input with the data that came from the server
            $("#id_colour").html(data);  // replace the contents of the city input with the data that came from the server
            }
        });
        alert(data);

      }
</script>
<!--   ---------------------------------------------  -->




{% endblock body %}